---
title: "MainMarkdown"
output: html_document
---

```{r load dependencies, echo = F}
library(tidyverse)
library(limma)
library(Biobase)
```


```{r setup, include = F}
gxData <- read.delim("./Data/MAGNET_GeneExpressionData_CPM_19112020.txt", as.is = T, row.names = 1)
sampleInfo <- read.delim("./Data/MAGNET_SampleData_19112020.txt", as.is = T, row.names = 1)
geneTotExonLengths <- read.delim("./Data/MAGNET_exonLengths.txt", as.is = T, row.names = 1)
```

```{python, echo = F}
import pandas as pd
import seaborn as sns

```

differential gene expression 
```{r Differential Gene Expression, echo = F}
# Create ExpressionSet object
eset <- ExpressionSet(assayData = data.matrix(gxData), phenoData = AnnotatedDataFrame(sampleInfo))

design <- model.matrix(~0+Disease, data = pData(eset))

# Create a contrasts matrix
cm <- makeContrasts(
  DonorVsPPCM = DiseaseDonor - DiseasePPCM, 
  DonorVsHCM = DiseaseDonor - DiseaseHCM, 
  DonorVsDCM = DiseaseDonor - DiseaseDCM,
  levels = design)

# Fit the model
fit <- lmFit(eset, design)

# Fit the contrasts
fit2 <- contrasts.fit(fit, contrasts = cm)

# Calculate the t-statistics for the contrasts
fit2 <- eBayes(fit2)

# Summarize results
diffGenExprTestData <- topTable(fit2, adjust = "BH", number = nrow(gxData))
diffGenExprTestDecision <- decideTests(fit2, adjust.method = "BH", p.value = 0.05, lfc = 1)
diffGenExprMerge <- merge(diffGenExprTestData, diffGenExprTestDecision, by="row.names",all.x=TRUE)  %>% column_to_rownames(var = "Row.names")
summary(diffGenExprTestDecision)
```
```{r Gene Enrichment Analysis, echo = F}



```


